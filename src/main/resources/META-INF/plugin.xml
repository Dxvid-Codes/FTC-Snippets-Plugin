<idea-plugin>
    <id>com.ontalent.ftcsnippets</id>
    <name>FTC Snippets</name>
    <vendor>LTC7 Programming team (#23594)</vendor>

    <!-- Dependencies -->
    <depends>com.intellij.modules.platform</depends>
    <depends>com.intellij.modules.java</depends>
    <depends optional="true" config-file="android-studio.xml">com.android.tools.idea</depends>

    <description><![CDATA[
<p><b>NOTE:</b> This only works with the FTC SDK. You must download that before using this plugin, otherwise it's pointless.</p>
<p>FTC Snippets adds one-click code templates and import snippets for <b>FIRST Tech Challenge (FTC)</b> robot development.</p>

<p>Features:</p>
<ul>
    <li>Automatically inserts the required <code>package org.firstinspires.ftc.teamcode;</code> line</li>
    <li>Adds imports for motors, servos, sensors, IMU, and vision</li>
    <li>Optional injection of TeleOp and Autonomous skeleton code</li>
    <li><b>NEW:</b> FTC Error Helper - detects common programming mistakes</li>
</ul>

<p>Boost your productivity and get your robot code running faster!</p>

<p>Fill out the form for plugin improvements:
<a href="https://forms.gle/wPVPQSpShxgDJXgD6">Google Form</a></p>
]]></description>

    <change-notes><![CDATA[
    <ul>
        <li>Fixed action conflicts and duplicate IDs</li>
        <li>Fixed SVG icon sizing for IntelliJ Otter (2024.3+)</li>
        <li>Added FTC Error Helper inspection system</li>
    </ul>
    ]]></change-notes>

    <!-- IntelliJ build compatibility -->
    <idea-version since-build="243" until-build="252.*"/>

    <!-- Actions -->
    <actions>
        <!-- Define all actions ONCE with unique IDs -->
        <action id="FTC.AllImports"
                class="ontalent.ftcsnippets.actions.InsertAllImportsAction"
                text="All FTC Imports"
                description="Insert all common FTC imports">
            <keyboard-shortcut first-keystroke="ctrl shift F" keymap="$default"/>
        </action>

        <action id="FTC.TeleOp"
                class="ontalent.ftcsnippets.actions.InsertTeleOpImportsAction"
                text="TeleOp Skeleton"
                description="Insert TeleOp template code"/>

        <action id="FTC.Autonomous"
                class="ontalent.ftcsnippets.actions.InsertAutonomousImportsAction"
                text="Autonomous Skeleton"
                description="Insert Autonomous template code"/>

        <action id="FTC.HardwareMap"
                class="ontalent.ftcsnippets.actions.InsertHardwareMapAction"
                text="HardwareMap Auto Insert"
                description="Generate hardware initialization code"/>

        <action id="FTC.MotorImports"
                class="ontalent.ftcsnippets.actions.InsertMotorImportsAction"
                text="Motor Imports"
                description="Insert motor-related imports"/>

        <action id="FTC.ServoImports"
                class="ontalent.ftcsnippets.actions.InsertServoImportsAction"
                text="Servo Imports"
                description="Insert servo-related imports"/>

        <action id="FTC.SensorImports"
                class="ontalent.ftcsnippets.actions.InsertSensorImportsAction"
                text="Sensor Imports"
                description="Insert sensor-related imports"/>

        <action id="FTC.IMUImports"
                class="ontalent.ftcsnippets.actions.InsertIMUImportsAction"
                text="IMU Imports"
                description="Insert IMU-related imports"/>

        <action id="FTC.VisionImports"
                class="ontalent.ftcsnippets.actions.InsertVisionImportsAction"
                text="Camera Imports (EasyOpenCV)"
                description="Insert vision-related imports"/>

        <action id="FTC.ErrorCheck"
                class="ontalent.ftcsnippets.actions.FTCErrorCheckAction"
                text="Check FTC Errors"
                description="Run FTC error inspection on current file"
                icon="/icons/error_icon.svg">
            <keyboard-shortcut first-keystroke="ctrl shift E" keymap="$default"/>
        </action>

        <!-- Main Toolbar Group -->
        <group id="FTC.Toolbar.Group" text="FTC Tools" popup="true" icon="/icons/toolbar_icon.svg">
            <add-to-group group-id="MainToolbarRight" anchor="last"/>
            <add-to-group group-id="NavBarToolBar" anchor="last"/>

            <reference ref="FTC.AllImports"/>
            <separator/>
            <reference ref="FTC.TeleOp"/>
            <reference ref="FTC.Autonomous"/>
            <separator/>
            <reference ref="FTC.HardwareMap"/>
            <separator/>
            <reference ref="FTC.MotorImports"/>
            <reference ref="FTC.ServoImports"/>
            <reference ref="FTC.SensorImports"/>
            <reference ref="FTC.IMUImports"/>
            <reference ref="FTC.VisionImports"/>
        </group>

        <!-- Editor Context Menu Group -->
        <group id="FTC.Context.Group" text="FTC Snippets" popup="true">
            <add-to-group group-id="EditorPopupMenu" anchor="last"/>

            <reference ref="FTC.MotorImports"/>
            <reference ref="FTC.ServoImports"/>
            <reference ref="FTC.SensorImports"/>
            <reference ref="FTC.IMUImports"/>
            <reference ref="FTC.VisionImports"/>
            <separator/>
            <reference ref="FTC.AllImports"/>
            <separator/>
            <reference ref="FTC.TeleOp"/>
            <reference ref="FTC.Autonomous"/>
            <separator/>
            <reference ref="FTC.HardwareMap"/>
        </group>

        <!-- Standalone Error Check in Toolbar -->
        <group id="FTC.Error.Group">
            <add-to-group group-id="MainToolbarRight" anchor="last"/>
            <add-to-group group-id="NavBarToolBar" anchor="last"/>
            <reference ref="FTC.ErrorCheck"/>
        </group>
    </actions>

    <!-- Extensions -->
    <extensions defaultExtensionNs="com.intellij">
        <localInspection
                language="JAVA"
                shortName="FtcErrorInspection"
                displayName="FTC Error Helper"
                groupName="FTC Snippets"
                enabledByDefault="true"
                level="WARNING"
                implementationClass="ontalent.ftcsnippets.inspections.FtcErrorInspection"/>
    </extensions>
</idea-plugin>