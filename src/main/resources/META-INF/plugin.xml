<!-- plugin.xml -->

<idea-plugin>
    <id>com.ontalent.ftcsnippets</id>
    <name>FTC Snippets</name>
    <vendor>LTC7 Programming team (#23594)</vendor>

    <!-- Dependencies -->
    <depends>com.intellij.modules.platform</depends>
    <depends>com.intellij.modules.java</depends>
    <depends optional="true" config-file="android-studio.xml">com.android.tools.idea</depends>

    <description><![CDATA[
<p><b>NOTE:</b> This only works with the FTC SDK. You must download that before using this plugin, otherwise it's pointless.</p>
<p>FTC Snippets adds one-click code templates and import snippets for <b>FIRST Tech Challenge (FTC)</b> robot development.</p>

<p>Features:</p>
<ul>
    <li>Automatically inserts the required <code>package org.firstinspires.ftc.teamcode;</code> line</li>
    <li>Adds imports for motors, servos, sensors, IMU, and vision</li>
    <li>Optional injection of TeleOp and Autonomous skeleton code</li>
    <li><b>NEW:</b> FTC Error Helper - detects common programming mistakes</li>
</ul>

<p>Boost your productivity and get your robot code running faster!</p>

<p>Fill out the form for plugin improvements:
<a href="https://forms.gle/wPVPQSpShxgDJXgD6">Google Form</a></p>
]]></description>

    <change-notes><![CDATA[
    <ul>
        <li>Fixed SVG icon sizing for IntelliJ Otter (2024.3+)</li>
        <li>Added FTC Error Helper inspection system</li>
        <li>Improved plugin structure and organization</li>
    </ul>
    ]]></change-notes>

    <!-- IntelliJ build compatibility -->
    <idea-version since-build="243" until-build="252.*"/>

    <!-- Actions -->
    <actions>
        <!-- Main Toolbar Group - Updated for Otter -->
        <group id="FTCImportsToolbarGroup" text="FTC Tools" popup="true" icon="/icons/toolbar_icon.svg">
            <!-- Multiple toolbar locations for Otter compatibility -->
            <add-to-group group-id="MainToolbarRight" anchor="last"/>
            <add-to-group group-id="NavBarToolBar" anchor="last"/>

            <!-- ALL YOUR ORIGINAL SNIPPETS -->
            <action id="InsertAllImports"
                    class="ontalent.ftcsnippets.actions.InsertAllImportsAction"
                    text="All FTC Imports">
                <keyboard-shortcut first-keystroke="ctrl shift F" keymap="$default"/>
            </action>

            <separator/>

            <action id="InsertTeleOpImports"
                    class="ontalent.ftcsnippets.actions.InsertTeleOpImportsAction"
                    text="TeleOp Skeleton"/>

            <action id="InsertAutonomousImports"
                    class="ontalent.ftcsnippets.actions.InsertAutonomousImportsAction"
                    text="Autonomous Skeleton"/>

            <separator/>

            <action id="InsertHardwareMapAction"
                    class="ontalent.ftcsnippets.actions.InsertHardwareMapAction"
                    text="HardwareMap Auto Insert"/>

            <separator/>

            <!-- Individual imports -->
            <action id="InsertMotorImports"
                    class="ontalent.ftcsnippets.actions.InsertMotorImportsAction"
                    text="Motor Imports"/>

            <action id="InsertServoImports"
                    class="ontalent.ftcsnippets.actions.InsertServoImportsAction"
                    text="Servo Imports"/>

            <action id="InsertSensorImports"
                    class="ontalent.ftcsnippets.actions.InsertSensorImportsAction"
                    text="Sensor Imports"/>

            <action id="InsertIMUImports"
                    class="ontalent.ftcsnippets.actions.InsertIMUImportsAction"
                    text="IMU Imports"/>

            <action id="InsertVisionImports"
                    class="ontalent.ftcsnippets.actions.InsertVisionImportsAction"
                    text="Camera Imports (EasyOpenCV)"/>
        </group>

        <!-- Editor Context Menu Group - Keep your original structure -->
        <group id="FTCImportsGroup" text="FTC Snippets" popup="true">
            <add-to-group group-id="EditorPopupMenu" anchor="last"/>

            <!-- ALL YOUR ORIGINAL SNIPPETS in context menu -->
            <action id="InsertMotorImportsContext"
                    class="ontalent.ftcsnippets.actions.InsertMotorImportsAction"
                    text="Motor Imports"/>

            <action id="InsertServoImportsContext"
                    class="ontalent.ftcsnippets.actions.InsertServoImportsAction"
                    text="Servo Imports"/>

            <action id="InsertSensorImportsContext"
                    class="ontalent.ftcsnippets.actions.InsertSensorImportsAction"
                    text="Sensor Imports"/>

            <action id="InsertIMUImportsContext"
                    class="ontalent.ftcsnippets.actions.InsertIMUImportsAction"
                    text="IMU Imports"/>

            <action id="InsertVisionImportsContext"
                    class="ontalent.ftcsnippets.actions.InsertVisionImportsAction"
                    text="Camera Imports (EasyOpenCV)"/>

            <separator/>

            <action id="InsertAllImportsContext"
                    class="ontalent.ftcsnippets.actions.InsertAllImportsAction"
                    text="All FTC Imports"/>

            <separator/>

            <action id="InsertTeleOpImportsContext"
                    class="ontalent.ftcsnippets.actions.InsertTeleOpImportsAction"
                    text="TeleOp Skeleton"/>

            <action id="InsertAutonomousImportsContext"
                    class="ontalent.ftcsnippets.actions.InsertAutonomousImportsAction"
                    text="Autonomous Skeleton"/>

            <separator/>

            <action id="InsertHardwareMapActionContext"
                    class="ontalent.ftcsnippets.actions.InsertHardwareMapAction"
                    text="HardwareMap Auto Insert"/>
        </group>

        <!-- Standalone Error Check Action -->
        <action id="FTCErrorCheck"
                class="ontalent.ftcsnippets.actions.FTCErrorCheckAction"
                text="Check FTC Errors"
                description="Run FTC error inspection on current file"
                icon="/icons/error_icon.svg">
            <!-- Add to multiple toolbar locations -->
            <add-to-group group-id="MainToolbarRight" anchor="last"/>
            <add-to-group group-id="NavBarToolBar" anchor="last"/>
            <keyboard-shortcut first-keystroke="ctrl shift E" keymap="$default"/>
        </action>
    </actions>

    <!-- Extensions -->
    <extensions defaultExtensionNs="com.intellij">
        <localInspection
                language="JAVA"
                shortName="FtcErrorInspection"
                displayName="FTC Error Helper"
                groupName="FTC Snippets"
                enabledByDefault="true"
                level="WARNING"
                implementationClass="ontalent.ftcsnippets.inspections.FtcErrorInspection"/>
    </extensions>
</idea-plugin>